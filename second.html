<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Birthday Gift </title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=DynaPuff&display=swap');

  body {
    margin: 0;
    overflow: hidden;
    background: black;
    font-family: 'DynaPuff', cursive;
    color: white;
    user-select: none;
    position: relative;
    height: 100vh;
  }

  canvas {
    position: fixed;
    top: 0;
    left: 0;
    z-index: 0;
  }

  .gift-container {
    position: absolute;
    width: 180px;
    height: 180px;
    cursor: pointer;
    perspective: 800px;
    z-index: 1;

    /* Center the gift box */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  /* Gift base */
  .gift-base {
    position: absolute;
    bottom: 0;
    width: 180px;
    height: 130px;
    background: linear-gradient(135deg, #c63333, #7b1f1f);
    border-radius: 20px 20px 15px 15px;
    box-shadow: 0 0 20px #b33434;
    box-sizing: border-box;
    border: 4px solid #a22a2a;
  }

  /* Gift lid */
  .gift-lid {
    position: absolute;
    top: 0;
    width: 180px;
    height: 70px;
    background: linear-gradient(135deg, #ff5252, #9f2323);
    border-radius: 20px 20px 0 0;
    border-bottom: 4px solid #a22a2a;
    box-shadow: 0 0 25px #ff4a4a;
    transform-origin: bottom center;
    transition: transform 0.8s ease, opacity 0.8s ease;
    box-sizing: border-box;
    z-index: 10;
  }

  /* Ribbon vertical */
  .ribbon-vertical {
    position: absolute;
    top: 0;
    left: 50%;
    width: 30px;
    height: 180px;
    background: linear-gradient(135deg, #ff7a7a, #b73232);
    transform: translateX(-50%);
    border-radius: 6px;
    box-shadow: 0 0 15px #ff6f6f;
    z-index: 15;
  }

  /* Ribbon horizontal */
  .ribbon-horizontal {
    position: absolute;
    top: 75px;
    left: 0;
    width: 180px;
    height: 30px;
    background: linear-gradient(135deg, #ff7a7a, #b73232);
    border-radius: 6px;
    box-shadow: 0 0 15px #ff6f6f;
    z-index: 15;
  }

  /* Bow container */
  .bow {
    position: absolute;
    top: -30px;
    left: 50%;
    width: 90px;
    height: 60px;
    transform: translateX(-50%);
    pointer-events: none;
    z-index: 20;
  }

  /* Bow loops */
  .bow .loop {
    position: absolute;
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #ff9999, #cc5555);
    border-radius: 60% 40% 60% 40% / 40% 60% 40% 60%;
    box-shadow: 0 0 18px #ff9999;
    top: 0;
  }
  .bow .loop.left {
    left: 0;
    transform: rotate(-35deg);
    transform-origin: right center;
  }
  .bow .loop.right {
    right: 0;
    transform: rotate(35deg);
    transform-origin: left center;
  }

  /* Open state for lid */
  .gift-lid.open {
    transform: rotateX(-120deg);
    opacity: 0;
  }

  /* Fade out entire gift */
  .gift-container.fade-out {
    animation: fadeOut 1s forwards;
  }

  @keyframes fadeOut {
    to {
      opacity: 0;
      transform: scale(0.8);
    }
  }

  /* Reveal image styling */
  .reveal-image {
    position: absolute;
    width: 680px;
    height: 750px;
    border-radius: 15px;
    box-shadow: 0 0 30px #ffffff;
    opacity: 0;
    transform-origin: center center;
    transform: scale(0.1);
    transition:
      opacity 1s ease 1.8s,
      transform 1s ease 1.8s,
      left 1s ease 1.8s,
      top 1s ease 1.8s;
    z-index: 5;
    object-fit: cover;
  }
  .reveal-image.visible {
    opacity: 1;
    transform: scale(1);
  }
</style>
</head>
<body>

<canvas id="stars"></canvas>

<div class="gift-container" id="gift">
  <div class="gift-lid" id="lid"></div>
  <div class="gift-base"></div>
  <div class="ribbon-vertical"></div>
  <div class="ribbon-horizontal"></div>
  <div class="bow">
    <div class="loop left"></div>
    <div class="loop right"></div>
  </div>
</div>

<!-- Hidden image to reveal -->
<img id="revealImg" class="reveal-image" src="Hanh.jpg" alt="Surprise Gift" />

<script>
  // Stars background setup with smooth twinkle
  const canvas = document.getElementById('stars');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const stars = [];
  for(let i = 0; i < 200; i++) {
    stars.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      r: Math.random() * 1.5 + 0.3,
      twinkleSpeed: Math.random() * 0.01 + 0.005,
      twinklePhase: Math.random() * Math.PI * 2
    });
  }

  function drawStars(time = 0) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    stars.forEach(star => {
      const alpha = 0.5 + 0.5 * Math.sin(time * star.twinkleSpeed * 1000 + star.twinklePhase);
      ctx.beginPath();
      ctx.arc(star.x, star.y, star.r, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(255,255,255,${alpha.toFixed(2)})`;
      ctx.shadowColor = 'white';
      ctx.shadowBlur = alpha * 10;
      ctx.fill();
    });
  }

  function animate(time = 0) {
    drawStars(time / 1000);
    requestAnimationFrame(animate);
  }
  animate();

  // Gift open & image reveal logic
  const gift = document.getElementById('gift');
  const lid = document.getElementById('lid');
  const revealImg = document.getElementById('revealImg');

  gift.addEventListener('click', () => {
    if (!lid.classList.contains('open')) {
      // Get gift's bounding box relative to viewport
      const rect = gift.getBoundingClientRect();

      // Set image start position exactly over gift box
      revealImg.style.left = rect.left + 'px';
      revealImg.style.top = rect.top + 'px';

      lid.classList.add('open');

      setTimeout(() => {
        gift.classList.add('fade-out');
      }, 300);

      setTimeout(() => {
        gift.style.display = 'none';
        revealImg.classList.add('visible');

        // After reveal, center the image on screen
        revealImg.style.left = (window.innerWidth / 2 - revealImg.offsetWidth / 2) + 'px';
        revealImg.style.top = (window.innerHeight / 2 - revealImg.offsetHeight / 2) + 'px';
      }, 500);
    }
  });

  // Resize canvas and reposition image if visible
  window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    if (revealImg.classList.contains('visible')) {
      revealImg.style.left = (window.innerWidth / 2 - revealImg.offsetWidth / 2) + 'px';
      revealImg.style.top = (window.innerHeight / 2 - revealImg.offsetHeight / 2) + 'px';
    }
  });
</script>

</body>
</html>
